import streamlit as st

# --- 1. Streamlit ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™” ---
# í˜ì´ì§€ ì´ë™ ë° ì„¤ë¬¸ ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì„¸ì…˜ ìƒíƒœ ë³€ìˆ˜ ì´ˆê¸°í™”
if 'page' not in st.session_state:
    st.session_state.page = 'main'  # í˜„ì¬ í˜ì´ì§€
if 'survey_answers' not in st.session_state:
    st.session_state.survey_answers = {}  # ì‚¬ìš©ìì˜ ì„¤ë¬¸ ì‘ë‹µ ì €ì¥
if 'total_score' not in st.session_state:
    st.session_state.total_score = 0  # ì´ ë²ˆì•„ì›ƒ ì ìˆ˜
if 'ee_score' not in st.session_state:
    st.session_state.ee_score = 0  # ê°ì • ì†Œì§„ ì ìˆ˜
if 'dp_score' not in st.session_state:
    st.session_state.dp_score = 0  # ë¹„ì¸ê²©í™” ì ìˆ˜
if 'rpa_score' not in st.session_state:
    st.session_state.rpa_score = 0  # ìì•„ì„±ì·¨ê° ì €í•˜ ì ìˆ˜
if 'burnout_stage_info' not in st.session_state:
    st.session_state.burnout_stage_info = {} # ë²ˆì•„ì›ƒ ë‹¨ê³„ ì •ë³´ (ë™ë¬¼, ì„¤ëª… ë“±)
if 'privacy_agreed' not in st.session_state:
    st.session_state.privacy_agreed = False # ê°œì¸ì •ë³´ ë™ì˜ ì—¬ë¶€

# --- 2. ì„¤ë¬¸ ë¬¸í•­ ì •ì˜ ---
# MBI-ES (Maslach Burnout Inventory - Educators Survey) ê¸°ë°˜ìœ¼ë¡œ ê°„ì†Œí™”ëœ ì„¤ë¬¸ ë¬¸í•­
# ê° ë¬¸í•­ì€ 7ì  ë¦¬ì»¤íŠ¸ ì²™ë„ (0ì : ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤ ~ 6ì : ë§¤ì¼ ê·¸ë ‡ë‹¤)
# 'category': 'EE' (Emotional Exhaustion), 'DP' (Depersonalization), 'RPA' (Reduced Personal Accomplishment)
survey_questions = [
    {"id": "q1", "text": "ë‚˜ëŠ” ì—…ë¬´ ë•Œë¬¸ì— **ì •ì‹ ì ìœ¼ë¡œ ì§€ì³** ìˆìŠµë‹ˆë‹¤. ğŸ§ ", "category": "EE"},
    {"id": "q2", "text": "ë‚˜ëŠ” ì¼ê³¼ì‹œê°„ì´ ëë‚  ë•Œì¯¤ **ë…¹ì´ˆ**ê°€ ë©ë‹ˆë‹¤. ğŸ”‹", "category": "EE"},
    {"id": "q3", "text": "ë‚˜ëŠ” ì•„ì¹¨ì— ì¼ì–´ë‚˜ ì¼í•  ìƒê°ì„ í•˜ë©´ **í”¼ê³¤í•¨**ì„ ëŠë‚ë‹ˆë‹¤. ğŸ¥±", "category": "EE"},
    {"id": "q4", "text": "í•˜ë£¨ ì¢…ì¼ í•™ìƒë“¤ê³¼ í•¨ê»˜ ì¼í•˜ëŠ” ê²ƒì€ ë‚˜ì—ê²Œ ì •ë§ **í˜ë“  ì¼**ì…ë‹ˆë‹¤. ğŸ˜©", "category": "EE"},
    {"id": "q5", "text": "ë‚˜ëŠ” ë‚˜ì˜ ì¼ë¡œ ì¸í•´ ë§¤ìš° **ì§€ì³** ìˆìŠµë‹ˆë‹¤. ğŸ˜µâ€ğŸ’«", "category": "EE"},
    {"id": "q6", "text": "ë‚˜ëŠ” ë‚˜ì˜ ì¼ë¡œ ì¸í•´ **ì¢Œì ˆê°**ì„ ëŠë‚ë‹ˆë‹¤. ğŸ˜”", "category": "EE"},
    {"id": "q7", "text": "ë‚˜ëŠ” ë‚´ê°€ ë‚˜ì˜ ì¼ì„ ë„ˆë¬´ **ì—´ì‹¬íˆ** í•˜ê³  ìˆë‹¤ê³  ëŠë‚ë‹ˆë‹¤. ğŸ”¥", "category": "EE"},
    {"id": "q8", "text": "í•™ìƒë“¤ê³¼ ì§ì ‘ ëŒ€í•˜ëŠ” ì¼ì€ ë‚˜ì—ê²Œ ë§¤ìš° í° **ìŠ¤íŠ¸ë ˆìŠ¤**ë¥¼ ë§Œë“­ë‹ˆë‹¤. ğŸ’¢", "category": "EE"},
    {"id": "q9", "text": "ë‚˜ëŠ” ë‚´ê°€ **í•œê³„ì— ë‹¤ë‹¤ë¥´ê³ ** ìˆë‹¤ê³  ëŠë‚ë‹ˆë‹¤. ğŸš§", "category": "EE"},
    {"id": "q10", "text": "ë‚˜ëŠ” ì¼ë¶€ í•™ìƒì„ ëŒ€í•  ë•Œ, **ì¸ê²©ì´ ì—†ëŠ” ì‚¬ë¬¼ì²˜ëŸ¼** ëŒ€í•˜ê³  ìˆë‹¤ê³  ëŠë‚ë‹ˆë‹¤. ğŸ¤–", "category": "DP"},
    {"id": "q11", "text": "ë‚˜ëŠ” ì¼ì„ ì‹œì‘í•œ í›„ í•™ìƒë“¤ì—ê²Œ **ê°ì •ì´ ë©”ë§ë¼ì¡ŒìŠµë‹ˆë‹¤**. ğŸ‚", "category": "DP"},
    {"id": "q12", "text": "ë‚˜ëŠ” ë‚´ê°€ **ì†ìˆ˜ë¬´ì±…**ì¸ ê²ƒì²˜ëŸ¼ ëŠê»´ì§ˆ ë•Œê°€ ìˆìŠµë‹ˆë‹¤. ğŸ¤·", "category": "DP"},
    {"id": "q13", "text": "ë‚˜ëŠ” ì¼ë¶€ í•™ìƒë“¤ì—ê²Œ ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ”ì§€ **ë³„ë¡œ ì‹ ê²½ ì“°ì§€ ì•ŠìŠµë‹ˆë‹¤**. ğŸ˜", "category": "DP"},
    {"id": "q14", "text": "ë‚˜ëŠ” í•™ìƒë“¤ì´ ì¼ë¶€ ê·¸ë“¤ì˜ ë¬¸ì œ ì±…ì„ì„ ë‚˜ì—ê²Œ **ëŒë¦¬ê³  ìˆë‹¤ê³ ** ëŠë‚ë‹ˆë‹¤.  blaming", "category": "DP"},
    {"id": "q15", "text": "ë‚˜ëŠ” í•™ìƒë“¤ì˜ ê°ì •ì„ **ì˜ ì´í•´**í•©ë‹ˆë‹¤. ğŸ‘", "category": "RPA"}, # ì—­ì±„ì  í•„ìš”
    {"id": "q16", "text": "ë‚˜ëŠ” í•™ìƒë“¤ì˜ ë¬¸ì œë¥¼ **íš¨ê³¼ì ìœ¼ë¡œ ë‹¤ë£¹ë‹ˆë‹¤**. âœ…", "category": "RPA"}, # ì—­ì±„ì  í•„ìš”
    {"id": "q17", "text": "ë‚˜ëŠ” ë‚˜ì˜ ì¼ì„ í†µí•´ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì—ê²Œ **ê¸ì •ì ì¸ ì˜í–¥ì„ ì£¼ê³ ** ìˆë‹¤ê³  ëŠë‚ë‹ˆë‹¤. âœ¨", "category": "RPA"}, # ì—­ì±„ì  í•„ìš”
    {"id": "q18", "text": "ë‚˜ëŠ” ë§¤ìš° **í™œê¸°ì°¨ë‹¤**ê³  ëŠë‚ë‹ˆë‹¤. âš¡", "category": "RPA"}, # ì—­ì±„ì  í•„ìš”
    {"id": "q19", "text": "ë‚˜ëŠ” í•™ìƒë“¤ì—ê²Œ **í¸ì•ˆí•œ ë¶„ìœ„ê¸°ë¥¼ ì‰½ê²Œ ì¡°ì„±**í•´ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ˜Œ", "category": "RPA"}, # ì—­ì±„ì  í•„ìš”
    {"id": "q20", "text": "ë‚˜ëŠ” í•™ìƒë“¤ê³¼ ì¼ì´ ëë‚˜ê³  ì¹œë°€í•´ì§€ë©´ **ê¸°ìš´ì´ ë¶ë‹ìŠµë‹ˆë‹¤**. ğŸš€", "category": "RPA"}, # ì—­ì±„ì  í•„ìš”
    {"id": "q21", "text": "ë‚˜ëŠ” ì´ ì¼ì„ í†µí•´ ë§ì€ **ê°€ì¹˜ ìˆëŠ” ì¼ë“¤ì„ ì„±ì·¨**í–ˆìŠµë‹ˆë‹¤. ğŸ†", "category": "RPA"}, # ì—­ì±„ì  í•„ìš”
    {"id": "q22", "text": "ë‚˜ëŠ” ì¼ì„ í•˜ë©´ì„œ ê°ì •ì ì¸ ë¬¸ì œë“¤ì„ **ì¹¨ì°©í•˜ê²Œ ì²˜ë¦¬**í•©ë‹ˆë‹¤. ğŸ§˜", "category": "RPA"} # ì—­ì±„ì  í•„ìš”
]

# ë¦¬ì»¤íŠ¸ ì²™ë„ ì˜µì…˜ (0ì ë¶€í„° 6ì ê¹Œì§€)
likert_options = [
    "ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤ (0ì )",
    "ê±°ì˜ ê·¸ë ‡ì§€ ì•Šë‹¤ (1ì )",
    "ê°€ë” ê·¸ë ‡ë‹¤ (2ì )",
    "ìì£¼ ê·¸ë ‡ë‹¤ (3ì )",
    "ìƒë‹¹íˆ ê·¸ë ‡ë‹¤ (4ì )",
    "ë§¤ìš° ê·¸ë ‡ë‹¤ (5ì )",
    "ë§¤ì¼ ê·¸ë ‡ë‹¤ (6ì )"
]

# --- 3. ë²ˆì•„ì›ƒ ë‹¨ê³„ ì •ë³´ ì •ì˜ (ë™ë¬¼ ë¹„ìœ ) ---
# ì´ì  ê¸°ì¤€ (ìµœëŒ€ ì ìˆ˜ 22ë¬¸í•­ * 6ì  = 132ì )
burnout_stages = {
    "stage1": {
        "name": "í™œê¸°ì°¬ ë‹¤ëŒì¥",
        "emoji": "ğŸ¿ï¸", # ì´ëª¨ì§€ ì¶”ê°€
        "description": "ì—ë„ˆì§€ê°€ ë„˜ì¹˜ê³ , ì—…ë¬´ì— ëŒ€í•œ ì—´ì •ì´ ë†’ìœ¼ë©°, ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ë¥¼ ì˜ í•˜ê³  ìˆëŠ” ìƒíƒœì…ë‹ˆë‹¤. í˜„ì¬ì˜ ê¸ì •ì ì¸ ìƒíƒœë¥¼ ìœ ì§€í•˜ë©° ë”ìš± ë°œì „í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        "recommendations": [
            "ê¾¸ì¤€í•œ ìê¸° ê´€ë¦¬ì™€ ê¸ì •ì ì¸ ìŠµê´€ì„ ìœ ì§€í•˜ì„¸ìš”.",
            "ìƒˆë¡œìš´ ë„ì „ê³¼ í•™ìŠµ ê¸°íšŒë¥¼ ì°¾ì•„ë³´ì„¸ìš”.",
            "ì£¼ë³€ ë™ë£Œ ë° ê°€ì¡±ê³¼ì˜ ê¸ì •ì ì¸ ê´€ê³„ë¥¼ ìœ ì§€í•˜ê³  ê°•í™”í•˜ì„¸ìš”."
        ],
        "score_range": (0, 26)
    },
    "stage2": {
        "name": "ì§€ì¹œ ê³ ì–‘ì´",
        "emoji": "ğŸˆ", # ì´ëª¨ì§€ ì¶”ê°€
        "description": "ê°€ë” í”¼ë¡œê°ì„ ëŠë¼ê³ , ì—…ë¬´ì— ëŒ€í•œ ì‘ì€ ì§œì¦ì´ ìƒê¸°ì§€ë§Œ, ì•„ì§ ìŠ¤ìŠ¤ë¡œ íšŒë³µ ê°€ëŠ¥í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤. ì‘ì€ íœ´ì‹ê³¼ ë¦¬í”„ë ˆì‹œê°€ í•„ìš”í•©ë‹ˆë‹¤.",
        "recommendations": [
            "ì§§ì€ íœ´ì‹ ì‹œê°„(ì ì‹¬ì‹œê°„, ì‰¬ëŠ” ì‹œê°„)ì„ ì ê·¹ í™œìš©í•˜ì„¸ìš”.",
            "ì¢‹ì•„í•˜ëŠ” ì·¨ë¯¸ í™œë™ì´ë‚˜ ê°€ë²¼ìš´ ìš´ë™ìœ¼ë¡œ ê¸°ë¶„ ì „í™˜ì„ ì‹œë„í•˜ì„¸ìš”.",
            "ì¶©ë¶„í•œ ìˆ˜ë©´ ì‹œê°„ì„ í™•ë³´í•˜ê³  ìˆ˜ë©´ì˜ ì§ˆì„ ë†’ì—¬ë³´ì„¸ìš”."
        ],
        "score_range": (27, 52)
    },
    "stage3": {
        "name": "í˜ë“  ì½”ë¼ë¦¬",
        "emoji": "ğŸ˜", # ì´ëª¨ì§€ ì¶”ê°€
        "description": "ë§Œì„±ì ì¸ í”¼ë¡œì™€ í•¨ê»˜ ì—…ë¬´ì— ëŒ€í•œ ì˜ìš•ì´ ì €í•˜ë˜ê³ , ê°ì • ì¡°ì ˆì— ì–´ë ¤ì›€ì„ ê²ªê¸° ì‹œì‘í•˜ëŠ” ìƒíƒœì…ë‹ˆë‹¤. ì ê·¹ì ì¸ ìê¸° ëŒë´„ê³¼ ì£¼ë³€ì˜ ë„ì›€ì´ í•„ìš”í•œ ì‹œì ì…ë‹ˆë‹¤.",
        "recommendations": [
            "ê·œì¹™ì ì¸ íœ´ì‹ê³¼ ì¬ì¶©ì „ ì‹œê°„ì„ ê³„íší•˜ê³  ì‹¤ì²œí•˜ì„¸ìš”.",
            "ìŠ¤íŠ¸ë ˆìŠ¤ í•´ì†Œì— ë„ì›€ì´ ë˜ëŠ” ìì‹ ë§Œì˜ ë°©ë²•ì„ íƒìƒ‰í•˜ê³  ì ìš©í•˜ì„¸ìš”.",
            "ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë™ë£Œ, ì¹œêµ¬, ê°€ì¡±ê³¼ ì†”ì§í•˜ê²Œ ëŒ€í™”í•˜ë©° ê°ì •ì„ ë‚˜ëˆ„ì„¸ìš”.",
            "í•„ìš”í•˜ë‹¤ë©´ ì „ë¬¸ê°€ì™€ì˜ ìƒë‹´ì„ ì ê·¹ì ìœ¼ë¡œ ê³ ë ¤í•´ ë³´ì„¸ìš”."
        ],
        "score_range": (53, 78)
    },
    "stage4": {
        "name": "ì§€ì³ ì“°ëŸ¬ì§„ ì‚¬ì",
        "emoji": "ğŸ¦", # ì´ëª¨ì§€ ì¶”ê°€
        "description": "ê·¹ì‹¬í•œ ê°ì • ì†Œì§„, ë¹„ì¸ê²©í™”, ìì•„ì„±ì·¨ê° ì €í•˜ê°€ ëšœë ·í•˜ê²Œ ë‚˜íƒ€ë‚˜ë©°, ì¼ìƒìƒí™œì—ë„ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìƒíƒœì…ë‹ˆë‹¤. í˜¼ì í•´ê²°í•˜ê¸° ì–´ë ¤ìš°ë©°, ì „ë¬¸ê°€ì˜ ë„ì›€ì´ ì ˆì‹¤íˆ í•„ìš”í•œ ì‹œì ì…ë‹ˆë‹¤.",
        "recommendations": [
            "ì¦‰ê°ì ì¸ íœ´ì‹ê³¼ ì—…ë¬´ ë¶€ë‹´ ê²½ê°ì´ í•„ìš”í•©ë‹ˆë‹¤. í•™êµ ë˜ëŠ” êµìœ¡ì²­ì— ë„ì›€ì„ ìš”ì²­í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•˜ì„¸ìš”.",
            "ì‹¬ë¦¬ ìƒë‹´ ì „ë¬¸ê°€ì™€ì˜ ì‹¬ì¸µ ìƒë‹´ì„ í†µí•´ ê·¼ë³¸ì ì¸ ì›ì¸ì„ íŒŒì•…í•˜ê³  í•´ê²° ë°©ì•ˆì„ ëª¨ìƒ‰í•˜ì„¸ìš”.",
            "ì‹ ì²´ì ì¸ ì¦ìƒì´ ë™ë°˜ëœë‹¤ë©´ ì˜ë£Œê¸°ê´€ì„ ë°©ë¬¸í•˜ì—¬ ì§„ë£Œë¥¼ ë°›ìœ¼ì„¸ìš”."
        ],
        "score_range": (79, 104)
    },
    "stage5": {
        "name": "ë™ë©´í•˜ëŠ” ê³°",
        "emoji": "ğŸ»", # ì´ëª¨ì§€ ì¶”ê°€
        "description": "ëª¨ë“  ì—ë„ˆì§€ê°€ ê³ ê°ˆë˜ì–´ ë¬´ê¸°ë ¥í•˜ê³ , ì‚¬íšŒì  ê´€ê³„ë¥¼ íšŒí”¼í•˜ë©°, ì‹¬ê°í•œ ì‹ ì²´ì /ì •ì‹ ì  ì¦ìƒì„ ë³´ì´ëŠ” ìƒíƒœì…ë‹ˆë‹¤. ì¦‰ê°ì ì¸ íœ´ì‹ê³¼ ì „ë¬¸ì ì¸ ì¹˜ë£Œê°€ í•„ìš”í•œ ìœ„ê¸‰í•œ ìƒíƒœì…ë‹ˆë‹¤.",
        "recommendations": [
            "ìµœìš°ì„ ì ìœ¼ë¡œ ì „ë¬¸ ì˜ë£Œê¸°ê´€(ì •ì‹ ê±´ê°•ì˜í•™ê³¼)ì„ ë°©ë¬¸í•˜ì—¬ ì§„ë‹¨ ë° ì¹˜ë£Œë¥¼ ë°›ìœ¼ì„¸ìš”.",
            "ì¶©ë¶„í•œ íœ´ì‹ê³¼ íšŒë³µ ì‹œê°„ì„ í™•ë³´í•˜ê³ , ì—…ë¬´ì—ì„œ ì ì‹œ ë²—ì–´ë‚˜ ìì‹ ì„ ëŒë³´ëŠ” ë° ì§‘ì¤‘í•˜ì„¸ìš”.",
            "ê°€ì¡± ë° ì£¼ë³€ì˜ ì ê·¹ì ì¸ ì§€ì§€ì™€ ë„ì›€ì´ í•„ìš”í•©ë‹ˆë‹¤. ë„ì›€ì„ ìš”ì²­í•˜ëŠ” ê²ƒì„ ì£¼ì €í•˜ì§€ ë§ˆì„¸ìš”."
        ],
        "score_range": (105, 132)
    }
}

# --- 4. í˜ì´ì§€ ì´ë™ í•¨ìˆ˜ ---
def go_to_page(page_name):
    st.session_state.page = page_name

# --- 5. ë©”ì¸ í˜ì´ì§€ í•¨ìˆ˜ ---
def main_page():
    st.title("ğŸ‘¨â€ğŸ« êµì‚¬ ë²ˆì•„ì›ƒ ìê°€ ì§„ë‹¨ ì›¹ì‚¬ì´íŠ¸")
    st.markdown("""
    ì•ˆë…•í•˜ì„¸ìš”, ì„ ìƒë‹˜! ì´ ì›¹ì‚¬ì´íŠ¸ëŠ” ì„ ìƒë‹˜ì˜ ë²ˆì•„ì›ƒ ìƒíƒœë¥¼ ìµëª…ìœ¼ë¡œ ìê°€ ì§„ë‹¨í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ ì¹œê·¼í•œ 'ë™ë¬¼ ë¹„ìœ 'ë¥¼ í†µí•´ ì‹œê°ì ìœ¼ë¡œ ì•ˆë‚´í•˜ë©°, 
    ê°œì¸ ë§ì¶¤í˜• ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ ë¦¬ì†ŒìŠ¤ë¥¼ ì—°ê³„í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.
    
    ì„ ìƒë‹˜ì˜ ì†Œì¤‘í•œ ì •ì‹  ê±´ê°•ì„ ì§€í‚¤ê³ , ë” ë‚˜ì•„ê°€ í–‰ë³µí•œ êµìœ¡ í™˜ê²½ì„ ë§Œë“œëŠ” ë° ê¸°ì—¬í•˜ê³ ì í•©ë‹ˆë‹¤.
    """)

    st.subheader("ğŸ’¡ ì›¹ì‚¬ì´íŠ¸ ëª©í‘œ")
    st.markdown("""
    * ì„ ìƒë‹˜ë“¤ì´ ìì‹ ì˜ ë²ˆì•„ì›ƒ ìƒíƒœë¥¼ ì‰½ê³  ìµëª…ìœ¼ë¡œ ì§„ë‹¨í•  ìˆ˜ ìˆëŠ” í™˜ê²½ ì œê³µ
    * ì§„ë‹¨ ê²°ê³¼ë¥¼ ì§ê´€ì ì´ê³  ë¹„íŒë‹¨ì ì¸ ë™ë¬¼ ë¹„ìœ ë¡œ ì‹œê°í™”í•˜ì—¬ ì‹¬ë¦¬ì  ë¶€ë‹´ ê²½ê° ë° ê³µê°ëŒ€ í˜•ì„±
    * ì§„ë‹¨ ê²°ê³¼ì— ë”°ë¥¸ ë§ì¶¤í˜• ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ íŒ ë° ì „ë¬¸ ìƒë‹´ ë¦¬ì†ŒìŠ¤ ì œê³µ
    """)

    st.subheader("ğŸ”’ ê°œì¸ì •ë³´ ì²˜ë¦¬ ë°©ì¹¨ ë° ë™ì˜")
    st.info("""
    ë³¸ ì„¤ë¬¸ì€ ì„ ìƒë‹˜ì˜ ë²ˆì•„ì›ƒ ìƒíƒœë¥¼ ì§„ë‹¨í•˜ê¸° ìœ„í•œ ê²ƒìœ¼ë¡œ, **'ê±´ê°•ì— ê´€í•œ ì •ë³´'**ì— í•´ë‹¹ë  ìˆ˜ ìˆëŠ” **ë¯¼ê°ì •ë³´**ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.
    ì„ ìƒë‹˜ì˜ ê°œì¸ ì‹ë³„ ì •ë³´ëŠ” ì¼ì²´ ìˆ˜ì§‘ë˜ì§€ ì•Šìœ¼ë©°, ì„¤ë¬¸ ê²°ê³¼ëŠ” ìµëª…ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.
    ìˆ˜ì§‘ëœ ìµëª… ë°ì´í„°ëŠ” ì˜¤ì§ ì„œë¹„ìŠ¤ ê°œì„  ë° êµì‚¬ ë²ˆì•„ì›ƒ í˜„í™©ì— ëŒ€í•œ í†µê³„ì  ë¶„ì„(ê°œì¸ì„ ì‹ë³„í•  ìˆ˜ ì—†ëŠ” í˜•íƒœ)ì—ë§Œ í™œìš©ë©ë‹ˆë‹¤.
    
    **ë™ì˜ ê±°ë¶€ ì‹œ ë¶ˆì´ìµ:** ë³¸ ì„¤ë¬¸ì€ ììœ¨ì ì¸ ì°¸ì—¬ë¥¼ ì›ì¹™ìœ¼ë¡œ í•˜ë©°, ë™ì˜ë¥¼ ê±°ë¶€í•˜ì…”ë„ ì–´ë– í•œ ë¶ˆì´ìµë„ ì—†ìŠµë‹ˆë‹¤.
    """)

    # ê°œì¸ì •ë³´ ë™ì˜ ì²´í¬ë°•ìŠ¤
    st.session_state.privacy_agreed = st.checkbox("ìœ„ ê°œì¸ì •ë³´ ì²˜ë¦¬ ë°©ì¹¨ì— ë™ì˜í•©ë‹ˆë‹¤. (í•„ìˆ˜)", value=st.session_state.privacy_agreed)

    if st.session_state.privacy_agreed:
        st.button("ì„¤ë¬¸ ì‹œì‘í•˜ê¸°", on_click=go_to_page, args=('survey',))
    else:
        st.warning("ì„¤ë¬¸ì„ ì‹œì‘í•˜ë ¤ë©´ ê°œì¸ì •ë³´ ì²˜ë¦¬ ë°©ì¹¨ì— ë™ì˜í•´ì•¼ í•©ë‹ˆë‹¤.")

# --- 6. ì„¤ë¬¸ í˜ì´ì§€ í•¨ìˆ˜ ---
def survey_page():
    st.title("ğŸ“ êµì‚¬ ë²ˆì•„ì›ƒ ìê°€ ì§„ë‹¨ ì„¤ë¬¸")
    st.markdown("ë‹¤ìŒ ë¬¸í•­ì„ ì½ê³ , ìµœê·¼ 1ê°œì›” ë™ì•ˆ ìì‹ ì—ê²Œ í•´ë‹¹ë˜ëŠ” ì •ë„ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.")

    # ì„¤ë¬¸ í¼ ì‹œì‘
    with st.form(key='burnout_survey_form'):
        st.markdown("---")
        # ê° ë¬¸í•­ì— ëŒ€í•œ ë¼ë””ì˜¤ ë²„íŠ¼ ìƒì„±
        for q in survey_questions:
            # ê¸°ë³¸ê°’ ì„¤ì • (ì„ íƒë˜ì§€ ì•Šì€ ìƒíƒœ)
            default_index = likert_options.index(st.session_state.survey_answers.get(q['id'], likert_options[0]))
            st.session_state.survey_answers[q['id']] = st.radio(
                f"**{q['text']}**",
                likert_options,
                index=default_index,
                key=q['id'] # ê° ë¼ë””ì˜¤ ë²„íŠ¼ì˜ ê³ ìœ  í‚¤
            )
            st.markdown("---")
        
        submitted = st.form_submit_button("ê²°ê³¼ í™•ì¸í•˜ê¸°")

        if submitted:
            # ì ìˆ˜ ê³„ì‚°
            total_score = 0
            ee_score = 0
            dp_score = 0
            rpa_score = 0

            for q in survey_questions:
                # ì„ íƒëœ ì˜µì…˜ì—ì„œ ì ìˆ˜ ì¶”ì¶œ (ì˜ˆ: "ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤ (0ì )" -> 0)
                score_str = st.session_state.survey_answers[q['id']].split('(')[1].replace('ì )', '')
                score = int(score_str)

                # RPA (ìì•„ì„±ì·¨ê° ì €í•˜) ë¬¸í•­ì€ ì—­ì±„ì  (6ì  -> 0ì , 0ì  -> 6ì )
                if q['category'] == 'RPA':
                    score = 6 - score # 7ì  ì²™ë„ì—ì„œ 0-6ì  ê¸°ì¤€ì´ë¯€ë¡œ 6ì—ì„œ ëºŒ

                total_score += score
                if q['category'] == 'EE':
                    ee_score += score
                elif q['category'] == 'DP':
                    dp_score += score
                elif q['category'] == 'RPA':
                    rpa_score += score
            
            st.session_state.total_score = total_score
            st.session_state.ee_score = ee_score
            st.session_state.dp_score = dp_score
            st.session_state.rpa_score = rpa_score

            # ë²ˆì•„ì›ƒ ë‹¨ê³„ ê²°ì •
            st.session_state.burnout_stage_info = calculate_burnout_stage(total_score)
            
            go_to_page('result')

# --- 7. ë²ˆì•„ì›ƒ ë‹¨ê³„ ê³„ì‚° í•¨ìˆ˜ ---
def calculate_burnout_stage(score):
    for stage_key, stage_info in burnout_stages.items():
        min_score, max_score = stage_info["score_range"]
        if min_score <= score <= max_score:
            return stage_info
    return burnout_stages["stage5"] # ê¸°ë³¸ê°’ ë˜ëŠ” ìµœê³  ë‹¨ê³„

# --- 8. ê²°ê³¼ í˜ì´ì§€ í•¨ìˆ˜ ---
def result_page():
    st.title("ğŸ“Š ë‚˜ì˜ ë²ˆì•„ì›ƒ ì§„ë‹¨ ê²°ê³¼")

    stage_info = st.session_state.burnout_stage_info
    total_score = st.session_state.total_score
    
    # ë™ë¬¼ ì´ëª¨ì§€ ì¶”ê°€
    st.subheader(f"ë‹¹ì‹ ì˜ ë²ˆì•„ì›ƒ ìˆ˜ì¤€ì€ '{stage_info['name']}' {stage_info['emoji']} ë‹¨ê³„ì…ë‹ˆë‹¤.")
    st.markdown(f"**ì´ ë²ˆì•„ì›ƒ ì ìˆ˜: {total_score}ì  (ìµœëŒ€ 132ì )**")

    # ë²ˆì•„ì›ƒ ì§„í–‰ë„ ì‹œê°í™” (ê°„ë‹¨í•œ í”„ë¡œê·¸ë ˆìŠ¤ ë°”)
    max_total_score = 132
    progress_percentage = (total_score / max_total_score) * 100
    st.progress(int(progress_percentage))
    st.caption(f"ë²ˆì•„ì›ƒ ì§„í–‰ë„: {progress_percentage:.1f}%")

    st.markdown(f"### {stage_info['name']} {stage_info['emoji']}") # ì´ëª¨ì§€ ì¶”ê°€
    st.write(f"_{stage_info['description']}_")

    # ê° ë²ˆì•„ì›ƒ ì°¨ì›ë³„ ì ìˆ˜ í‘œì‹œ
    st.subheader("ì„¸ë¶€ ë²ˆì•„ì›ƒ ì§€í‘œ")
    col1, col2, col3 = st.columns(3)
    with col1:
        st.metric(label="ê°ì • ì†Œì§„ (Emotional Exhaustion)", value=f"{st.session_state.ee_score}ì ")
    with col2:
        st.metric(label="ë¹„ì¸ê²©í™” (Depersonalization)", value=f"{st.session_state.dp_score}ì ")
    with col3:
        st.metric(label="ìì•„ì„±ì·¨ê° ì €í•˜ (Reduced Personal Accomplishment)", value=f"{st.session_state.rpa_score}ì ")
    
    st.markdown("---")

    st.subheader("ğŸŒŸ ë‚˜ë¥¼ ìœ„í•œ ë§ì¶¤í˜• ê¶Œì¥ì‚¬í•­")
    for rec in stage_info['recommendations']:
        st.markdown(f"- {rec}")
    
    st.markdown("---")

    st.subheader("ğŸ”— ì „ë¬¸ê°€ ì—°ê³„ ì •ë³´")
    st.markdown("""
    ë³´ë‹¤ ì •í™•í•œ ì§„ë‹¨ê³¼ ì‹¬ì¸µì ì¸ ìƒë‹´ì´ í•„ìš”í•˜ë‹¤ë©´, ì•„ë˜ ì „ë¬¸ ê¸°ê´€ì˜ ë„ì›€ì„ ë°›ì•„ë³´ì„¸ìš”.
    * **êµì›ì¹˜ìœ ì§€ì›ì„¼í„°:** ê° ì‹œë„ êµìœ¡ì²­ì—ì„œ ìš´ì˜í•˜ë©° êµì›ë“¤ì˜ ì‹¬ë¦¬ì  ì–´ë ¤ì›€ì„ ì§€ì›í•©ë‹ˆë‹¤. (í•´ë‹¹ ì§€ì—­ êµìœ¡ì²­ ì›¹ì‚¬ì´íŠ¸ ì°¸ê³ )
    * **êµ­ê°€íŠ¸ë¼ìš°ë§ˆì„¼í„°:** ì¬ë‚œ ë° ì™¸ìƒ í›„ ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ë¥¼ ìœ„í•œ ì „ë¬¸ ìƒë‹´ì„ ì œê³µí•©ë‹ˆë‹¤. [êµ­ê°€íŠ¸ë¼ìš°ë§ˆì„¼í„°](https://www.ncmh.go.kr/nct/)
    * **ì •ì‹ ê±´ê°•ë³µì§€ì„¼í„°:** ì§€ì—­ì‚¬íšŒ ê¸°ë°˜ì˜ ì •ì‹ ê±´ê°• ì¦ì§„ ë° ìƒë‹´ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. (ê±°ì£¼ ì§€ì—­ ì •ì‹ ê±´ê°•ë³µì§€ì„¼í„° ê²€ìƒ‰)
    """)

    st.warning("âš ï¸ **ë©´ì±… ì¡°í•­:** ë³¸ ì›¹ì‚¬ì´íŠ¸ì˜ ì§„ë‹¨ ê²°ê³¼ëŠ” ìê°€ ì§„ë‹¨ì„ ìœ„í•œ ì°¸ê³  ìë£Œì´ë©°, ì „ë¬¸ì ì¸ ì˜í•™ì  ë˜ëŠ” ì‹¬ë¦¬ì  ì§„ë‹¨ì„ ëŒ€ì²´í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì •í™•í•œ ì§„ë‹¨ê³¼ ìƒë‹´ì„ ìœ„í•´ì„œëŠ” ë°˜ë“œì‹œ ì „ë¬¸ê°€ì™€ ìƒì˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.")

    st.button("ë‹¤ì‹œ ì„¤ë¬¸í•˜ê¸°", on_click=go_to_page, args=('main',))

# --- 9. ë©”ì¸ ì•± ì‹¤í–‰ ë¡œì§ ---
if st.session_state.page == 'main':
    main_page()
elif st.session_state.page == 'survey':
    survey_page()
elif st.session_state.page == 'result':
    result_page()
